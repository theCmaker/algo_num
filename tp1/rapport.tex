\documentclass{report}
\usepackage[utf8]{inputenc} %encodage entrée
\usepackage{endnotes} %notes de fin
\usepackage{graphicx} %images
\usepackage[usenames,dvipsnames]{color} %couleurs
\usepackage{listings} %mise en forme de code source
\usepackage{xfrac}
\renewcommand\theequation{\arabic{equation}}
\usepackage{tabularx} % modifier la taille des cellules des tableaux
\usepackage{upquote}
\usepackage{textcomp}
\usepackage[frenchb]{babel} %langue
\usepackage{amsmath} %affichage des matrices
\usepackage{lipsum} %génération de lipsum
\usepackage{verbatim} %code source
\usepackage{moreverb} %amélioration du package verbatim
\usepackage{titlesec} %formatage des chapitres
\titleformat{\chapter}[hang]{\bf\huge}{\thechapter}{2pc}{}
\usepackage[a4paper]{geometry} %mise en page
\geometry{hscale=0.8,vscale=0.8,centering}
%\lstinputlisting[language=Python, firstline=37, lastline=45]{source_filename.py}
\title{Algorithmes numériques -- Rapport \\ \vspace{0.5cm}Résolution de systèmes linéaires}
\author{Axel Delsol, Pierre-Loup Pissavy}
\date{Novembre 2013}
\lstset{literate=
   {á}{{\'a}}1 {é}{{\'e}}1 {í}{{\'i}}1 {ó}{{\'o}}1 {ú}{{\'u}}1
   {Á}{{\'A}}1 {É}{{\'E}}1 {Í}{{\'I}}1 {Ó}{{\'O}}1 {Ú}{{\'U}}1
   {à}{{\`a}}1 {è}{{\`e}}1 {ì}{{\`i}}1 {ò}{{\`o}}1 {ò}{{\`u}}1
   {À}{{\`A}}1 {È}{{\`E}}1 {Ì}{{\`I}}1 {Ò}{{\`O}}1 {Ò}{{\`U}}1
   {ä}{{\"a}}1 {ë}{{\"e}}1 {ï}{{\"i}}1 {ö}{{\"o}}1 {ü}{{\"u}}1
   {Ä}{{\"A}}1 {Ë}{{\"E}}1 {Ï}{{\"I}}1 {Ö}{{\"O}}1 {Ü}{{\"U}}1
   {â}{{\^a}}1 {ê}{{\^e}}1 {î}{{\^i}}1 {ô}{{\^o}}1 {û}{{\^u}}1
   {Â}{{\^A}}1 {Ê}{{\^E}}1 {Î}{{\^I}}1 {Ô}{{\^O}}1 {Û}{{\^U}}1
   {œ}{{\oe}}1 {Œ}{{\OE}}1 {æ}{{\ae}}1 {Æ}{{\AE}}1 {ß}{{\ss}}1
   {ç}{{\c c}}1 {Ç}{{\c C}}1 {ø}{{\o}}1 {å}{{\r a}}1 {Å}{{\r A}}1
   {€}{{\EUR}}1 {£}{{\pounds}}1
}
\lstdefinestyle{customc}{
   belowcaptionskip=1\baselineskip,
   breaklines=true,
   frame=L,
   xleftmargin=\parindent,
   language=C,
   showstringspaces=false,
   basicstyle=\footnotesize\ttfamily,
   keywordstyle=\bfseries\color{ForestGreen},
   commentstyle=\itshape\color{Plum},
   identifierstyle=\color{NavyBlue},
   stringstyle=\color{Orange},
   numbers=left,
   caption=Code : \lstname,
   captionpos=b,
}
\lstset{
upquote=true,
columns=flexible,
basicstyle=\ttfamily,
}
\renewcommand{\lstlistingname}{\textsc{Figure}}
\lstdefinestyle{apercu}{
   	xleftmargin=2cm,
	xrightmargin=2cm,
	frame=single,
	breaklines=true,
	breakatwhitespace=true,
	breakindent=5pt,
	postbreak=\space,
	captionpos=b,
   	escapeinside={\%*}{*)},
   	showstringspaces=false,
   	caption=Apercu : \lstname,
}
\begin{document}
  \maketitle
  \tableofcontents

  \chapter{Préambule}
  	\section{Structure du programme}
    Nous avons conçu un programme principal avec menus, présenté sous la forme suivante :

    \begin{lstlisting}[style=apercu, name=Menu Principal]
MENU PRINCIPAL : RESOLUTION D'EQUATIONS LINEAIRES

1. Résolution par Gauss
3. Résolution par Cholesky
2. Résolution par Jacobi
4. Résolution par Gauss-Seidel
5. Résolution par Surrelaxation
6. Génération de matrices carrées
7. Jeux de test
0. Quitter
Votre choix : 
	\end{lstlisting}
	
	Toutes les fonctions de résolution font appel à des fonctions adaptées aux matrices, écrites dans le fichier \verb"matrices.c".
    \vspace{0.3cm}
    
    Chaque méthode de résolution reçoit les matrices (à éléments réels) générées auparavant (juste après le choix de la méthode dans le menu) en arguments.
    \vspace{0.3cm}
    	
	Chaque entrée du menu est codée dans un fichier source qui lui est propre (cf Figure \ref{arborescence}). Les fichiers headers correspondants contiennent les prototypes. Le fichier source \verb"main.c" contient le menu principal.
	\vspace{0.3cm}
	
    Les matrices sont générées juste après le choix de la méthode, avant d'être passées en arguments à la fonction de résolution.

    \lstinputlisting[style=apercu, name=Arborescence, label=arborescence]{arborescence}
    \vspace{0.3cm}

  Toutes les fonctions de résolution font appel à des fonctions intermédiaires, caractéristiques du calcul matriciel, écrites dans le fichier \verb"matrices.c" présenté en annexe, page \pageref{sourceMatrices}.
  \vspace{0.3cm}

	\section{Compilation}
    La compilation est gérée par un \verb"makefile".\\
    Le compilateur utilisé est \verb"GCC".
    Il suffit de taper \verb"make" pour lancer la compilation.\\
    Pour nettoyer les fichiers temporaires, il faudra taper \verb"make clean".\\
    Ce \verb"makefile" permet également de générer ce rapport ainsi que quelques fichiers qui y sont intégrés.

	\newpage
	\section{Systèmes testés}
	  Les matrices suivantes sont toutes symétriques définies positives à diagonale dominante. Nous avons choisi de prendre 10 systèmes pouvant être résolus par toutes les méthodes pour faciliter la comparaison des méthodes directes, itératives et directes-itératives.
	  \vspace{0.5cm}
	  
	          Systèmes :
        \begin{equation}
        \begin{pmatrix}
          2 & 1 & 0 & 0 \\
          1 & 3 & 1 & 0 \\
          0 & 1 & 5 & 1 \\
          0 & 0 & 1 & 2 \\
        \end{pmatrix}
        \cdot
        \begin{pmatrix}
          x_1 \\
          x_2 \\
          x_3 \\
          x_4 \\
        \end{pmatrix}
        =
        \begin{pmatrix}
          1 \\
          0 \\
          0 \\
          -1 \\
        \end{pmatrix}
        \label{syst1} % plus tard, utiliser ~\eqref{systX}
        \end{equation}
        \begin{equation}
        \begin{pmatrix}
          19 & 0 & 12 & -6 \\
          0 & 4 & 2 & 1 \\
          12 & 2 & 49 & -4 \\
          -6 & 1 & -4 & 51 \\
        \end{pmatrix}
        \cdot
        \begin{pmatrix}
          x_1 \\
          x_2 \\
          x_3 \\
          x_4 \\
        \end{pmatrix}
        =
        \begin{pmatrix}
          1 \\
          1 \\
          1 \\
          1 \\
        \end{pmatrix}
        \label{syst2}
        \end{equation}
        \begin{equation}
        \begin{pmatrix}
          5 & 1 & 1 & 1 \\
          1 & 13 & 5 & 5 \\
          1 & 5 & 49 & 14 \\
          1 & 5 & 14 & 51 \\
        \end{pmatrix}
        \cdot
        \begin{pmatrix}
          x_1 \\
          x_2 \\
          x_3 \\
          x_4 \\
        \end{pmatrix}
        =
        \begin{pmatrix}
          0 \\
          2 \\
          4 \\
          6 \\
        \end{pmatrix}
        \label{syst3}
        \end{equation}
        \begin{equation}
        \text{Matrice à bord : }
        \begin{pmatrix}
          1 & 0.5 & 0.25 \\
          0.5 & 1 & 0 \\
          0.25 & 0 & 1 \\
        \end{pmatrix}
        \cdot
        \begin{pmatrix}
          x_1 \\
          x_2 \\
          x_3 \\
        \end{pmatrix}
        =
        \begin{pmatrix}
          1 \\
          2 \\
          1 \\
        \end{pmatrix}
        \label{syst4}
        \end{equation}
        \begin{equation}
        \begin{pmatrix}
          1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
          0 & 9 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 \\
          0 & 1 & 3 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
          0 & 1 & 0 & 8 & 1 & 1 & 1 & 1 & 1 & 1 \\
          0 & 1 & 0 & 1 & 4 & 0 & 0 & 0 & 0 & 0 \\
          0 & 1 & 0 & 1 & 0 & 7 & 1 & 1 & 1 & 1 \\
          0 & 1 & 0 & 1 & 0 & 1 & 4 & 0 & 0 & 0 \\
          0 & 1 & 0 & 1 & 0 & 1 & 0 & 6 & 1 & 1 \\
          0 & 1 & 0 & 1 & 0 & 1 & 0 & 1 & 5 & 0 \\
          0 & 1 & 0 & 1 & 0 & 1 & 0 & 1 & 0 & 5 \\
        \end{pmatrix}
        \cdot
        \begin{pmatrix}
          x_1 \\
          x_2 \\
          x_3 \\
          x_4 \\
          x_5 \\
          x_6 \\
          x_7 \\
          x_8 \\
          x_9 \\
          x_{10} \\
        \end{pmatrix}
        =
        \begin{pmatrix}
          1 \\
          2 \\
          3 \\
          4 \\
          5 \\
          6 \\
          7 \\
          8 \\
          9 \\
          10 \\
        \end{pmatrix}
        \label{syst5}
        \end{equation}
        \begin{equation}
        \begin{pmatrix}
          4 & 1 & 0 \\
          1 & 4 & 1 \\
          0 & 1 & 4 \\
        \end{pmatrix}
        \cdot
        \begin{pmatrix}
          x_1 \\
          x_2 \\
          x_3 \\
        \end{pmatrix}
        =
        \begin{pmatrix}
          -5 \\
          6 \\
          7 \\
        \end{pmatrix}
        \label{syst6}
        \end{equation}
        \begin{equation}
        \begin{pmatrix}
          7 & -2 & 0 \\
          -2 & 9 & -6 \\
          0 & -6 & 25 \\
        \end{pmatrix}
        \cdot
        \begin{pmatrix}
          x_1 \\
          x_2 \\
          x_3 \\
        \end{pmatrix}
        =
        \begin{pmatrix}
          \sfrac{3}{2} \\
          \sfrac{3}{5} \\
          \sfrac{3}{4} \\
        \end{pmatrix}
        \label{syst7}
        \end{equation}
        \begin{equation}
        \begin{pmatrix}
          4 & 1 & 1 & 0 \\
          1 & 4 & 0 & 1 \\
          1 & 0 & 4 & 1 \\
          0 & 1 & 1 & 4 \\
        \end{pmatrix}
        \cdot
        \begin{pmatrix}
          x_1 \\
          x_2 \\
          x_3 \\
          x_4 \\
        \end{pmatrix}
        =
        \begin{pmatrix}
          0 \\
          0 \\
          0 \\
          24 \\
        \end{pmatrix}
        \label{syst8}
        \end{equation}
        \begin{equation}
        \begin{pmatrix}
          65 & 40 & 24 \\
          40 & 68 & 17 \\
          24 & 17 & 81 \\
        \end{pmatrix}
        \cdot
        \begin{pmatrix}
          x_1 \\
          x_2 \\
          x_3 \\
        \end{pmatrix}
        =
        \begin{pmatrix}
          1 \\
          1 \\
          1 \\
        \end{pmatrix}
        \label{syst9}
        \end{equation}
        \begin{equation}
        \text{Matrice KMS (}
        p=0.25\text{) :}
        \begin{pmatrix}
          1 & 0.25 & 0.0625 & 0.015625 \\
          0.25 & 1 & 0.25 & 0.0625 \\
          0.0625 & 0.25 & 1 & 0.25 \\
          0.015625 & 0.0625 & 0.25 & 1 \\
        \end{pmatrix}
        \cdot
        \begin{pmatrix}
          x_1 \\
          x_2 \\
          x_3 \\
          x_4 \\
        \end{pmatrix}
        =
        \begin{pmatrix}
          1 \\
          2 \\
          3 \\
          4 \\
        \end{pmatrix}
        \label{syst10}
        \end{equation}

	  
  \chapter{Méthodes directes}
    Les méthodes directes ont pour but d'obtenir des solutions exactes en simplifiant, étape par étape, le système donné sous la forme 
    $A_{n,n} \cdot X_{n,1} = B_{n,1}$ où :
    \begin{itemize}
     \item{$A$ est une matrice donnée}
     \item{$X$ est le vecteur solution}
     \item{$B$ est un vecteur colonne donné}
    \end{itemize}
	\vspace{0.3cm}    
    La résolution se fait en 2 étapes :
    \begin{enumerate}
     \item{On décompose la matrice $A_{n,n}$ tel que $A = M \cdot N$ où $M_{n,n}$ est facile à inverser et $N_{n,n}$ est triangulaire.}
     \item{On résout les systèmes suivants : 
           \begin{itemize}
            \item{On trouve $Y_{n,1}$ tel que $M \cdot Y = B$}
            \item{On trouve enfin $X_{n,1} $ tel quel $N \cdot X = Y$}
           \end{itemize}
           }
    \end{enumerate}
    \section{Méthode de Gauss}
      La méthode de Gauss permet de calculer une solution exacte en un nombre fini d'étapes.
      \newline
      On cherche la matrice $N$ triangulaire supérieure telle que $A = M \cdot N$ avec $M$ la matrice identité.
      \newline
      Remarque : La résolution du système $M \cdot Y = B$ est évidente puisque la matrice $M$ est la matrice identité.
      \newline
      Critère d'application de l'algorithme :
      \begin{itemize}
        \item{Les éléments diagonaux ne peuvent être nuls,}
        \item{Le déterminant ne doit pas être nul.}
      \end{itemize}
        \lstset{language=C,showstringspaces=false}
      \subsection{Programme}
        \lstinputlisting[style=customc]{gauss.c}
      \newpage
      \subsection{Résultats des tests}
      \renewcommand{\arraystretch}{2}
        \begin{tabular}{|c|c|c|c|}
           \hline
           Système & Résultat obtenu & Résultat théorique & Ecart \\ % ajout de hline entre chaque ligne pour séparer
           %debut eq1
           \hline
           ~\eqref{syst1} 
           & 
           $\begin{pmatrix}
              0.63415 \\
              -0.26829	\\
              0.17073	\\
              -0.58537 \\
			     \end{pmatrix}$          
           &
           $\begin{pmatrix}
              \frac{26}{41} \\
              -\frac{11}{41} \\
              \frac{7}{41} \\
              -\frac{24}{41} \\
			     \end{pmatrix}$
			     &
			     $0.0008213058895$ \\
			     %fin eq1
           %debut eq2
           \hline
           ~\eqref{syst2} 
           &
           $\begin{pmatrix}
              0.06132 \\
              0.24599	\\
              -0.00287	\\
              0.02177 \\
			     \end{pmatrix}$          
           &
           $\begin{pmatrix}
              \frac{3067}{50015} \\
              \frac{7382}{30009} \\
              -\frac{431}{150045} \\
              \frac{1089}{50015} \\
			     \end{pmatrix}$
			     &
			     $0.02643817358$ \\
			     %fin eq2
			     %debut eq3
           \hline
           ~\eqref{syst3} 
           &
           $\begin{pmatrix}
              -0.04885	\\
              0.10345	\\
              0.04458	\\
              0.09623 \\
			     \end{pmatrix}$
           &
           $\begin{pmatrix}
              -\frac{3375}{69088} \\
              \frac{7147}{69088} \\
              \frac{385}{8636} \\
              \frac{831}{8636} \\
          \end{pmatrix}$         
           &
           $0.002650860195$ \\
           %fin eq3
           %debut eq4
           \hline
           ~\eqref{syst4}
           &
           $\begin{pmatrix}
              -0.36364	 \\
              2.18182	\\
              1.09091 \\
          \end{pmatrix}$
           &
           $\begin{pmatrix}
              -\frac{4}{11} \\
              \frac{24}{11} \\
              \frac{12}{11} \\
			     \end{pmatrix}$
			     &
			     $0.0003888866667$ \\
			     %fin eq4
			     %debut eq5
           \hline
           ~\eqref{syst5} 
           &
           $\begin{pmatrix}
              1.00000	\\
              -0.81145	 \\
              1.27048	 \\
              -0.46016	 \\
              1.56790	 \\
              0.05780	\\
              2.05345	\\
              0.88005	\\
              1.86675	\\
              2.06675 \\
          \end{pmatrix}$
           &
           $\begin{pmatrix}
              1 \\
              -\frac{241}{297} \\
              \frac{1132}{891} \\
              -\frac{410}{891} \\
              \frac{127}{81} \\
              \frac{103}{1782} \\
              \frac{4879}{2376} \\
              \frac{697}{792} \\
              \frac{22177}{11880} \\
              \frac{24553}{11880} \\
          \end{pmatrix}$
          &
          $0.0001766790236$ \\
          %fin eq5
          \hline
          \end{tabular}
        \renewcommand{\arraystretch}{1}
        \newpage
        \renewcommand{\arraystretch}{2}
        \begin{tabular}{|c|c|c|c|}
           \hline
           Système & Résultat obtenu & Résultat théorique & Ecart \\ % ajout de hline entre chaque ligne pour séparer
          %debut eq6
           \hline
           ~\eqref{syst6}
           &
           $\begin{pmatrix}
              -1.64286 \\
              1.57143 \\
              1.35714 \\
          \end{pmatrix}$
           &
           $\begin{pmatrix}
              -\frac{23}{14} \\
              \frac{11}{7} \\
              \frac{19}{14} \\
          \end{pmatrix}$
          &
          $0.0001584521670$ \\
          %fin eq6
          %debut eq7
           \hline
           ~\eqref{syst7}
           &
           $\begin{pmatrix}
              0.26370 \\
              0.17294 \\
              0.07150 \\
          \end{pmatrix}$
           &
           $\begin{pmatrix}
              \frac{645}{2446} \\
              \frac{423}{2446} \\
              \frac{1749}{24460} \\
          \end{pmatrix}$
          &
          $0.003509317007$ \\
          %fin eq7
          %debut eq8
           \hline
           ~\eqref{syst8}
           &
           $\begin{pmatrix}
              1.00000 \\
              -2.00000 \\
              -2.00000 \\
              7.00000 \\
          \end{pmatrix}$
           &
           $\begin{pmatrix}
              1 \\
              -2 \\
              -2 \\
              7 \\
          \end{pmatrix}$
          &
          $0$ \\
          %fin eq8
          %debut eq9
           \hline
           ~\eqref{syst9}
           &
           $\begin{pmatrix}
              0.00707 \\
              0.00843 \\
              0.00848 \\
          \end{pmatrix}$
           &
           $\begin{pmatrix}
              \frac{1435}{203107} \\
              \frac{1712}{203107} \\
              \frac{1723}{203107} \\
          \end{pmatrix}$
          &
          $0.03881495963$ \\
          %fin eq9
          %debut eq10
           \hline
           ~\eqref{syst10}
           &
           $\begin{pmatrix}
              0.53333 \\
              1.20000 \\
              1.80000 \\
              3.46667
          \end{pmatrix}$
           &
           $\begin{pmatrix}
              \frac{8}{15} \\
              \frac{6}{5} \\
              \frac{9}{5} \\
              \frac{52}{15} \\
          \end{pmatrix}$
          &
          $0.0001802844952$ \\
          %fin eq10
          \hline

         \end{tabular}
         \renewcommand{\arraystretch}{1}
        
    \newpage
    \section{Méthode de Cholesky}
      La méthode de Cholesky est une décomposition $LU$ de $A$. On décompose la matrice $A$ en $R^T \cdot R$ où $R$ est triangulaire supérieure et $R^T$ sa transposée.

      Cette méthode permet également d'obtenir des solutions exactes en un nombre fini d'itérations.\\
      Cependant, elle est plus restrictive que Gauss pour les raisons suivantes :
      \begin{itemize}
        \item{$A$ doit être symétrique,}
        \item{$A$ doit être diagonale dominante.}
      \end{itemize}
      \subsection{Programme}
        \lstinputlisting[style=customc]{cholesky.c}
      \newpage
      \subsection{Résultats des tests}
      	\renewcommand{\arraystretch}{2}
        \begin{tabular}{|c|c|c|c|}
          \hline
          Système & Résultat obtenu & Résultat théorique & Ecart (en \%) \\ % ajout de hline entre chaque ligne pour séparer
          \hline
          ~\eqref{syst1}
          &
          $\begin{pmatrix}
              0.63415 \\
              -0.26829 \\
              0.17073 \\
              -0.58537 \\
           \end{pmatrix}$
          &
          $\begin{pmatrix}
              \frac{26}{41} \\
              -\frac{11}{41} \\
              \frac{7}{41} \\
              -\frac{24}{41} \\
          \end{pmatrix}$
          &
          $0.0008213058895$\\
          \hline
          ~\eqref{syst2}
          &
          $\begin{pmatrix}
              0.06132 \\
              0.24599 \\
              -0.00287 \\
              0.02177 \\
           \end{pmatrix}$
          &
          $\begin{pmatrix}
              \frac{3067}{50015} \\
              \frac{7382}{30009} \\
              -\frac{431}{150045} \\
              \frac{1089}{50015} \\
          \end{pmatrix}$
          &
          $0.02643817358$ \\
          \hline
          ~\eqref{syst3}
          &
          $\begin{pmatrix}
              -0.04885 \\
              0.10345 \\
              0.04458 \\
              0.09623 \\
           \end{pmatrix}$
          &
          $\begin{pmatrix}
              -\frac{3375}{69088} \\
              \frac{7147}{69088} \\
              \frac{385}{8636} \\
              \frac{831}{8636} \\
          \end{pmatrix}$         
           &
           $0.002650860195$ \\
          \hline
          ~\eqref{syst4}
          &
          $\begin{pmatrix}
              -0.36364 \\
              2.18182 \\
              1.09091 \\
           \end{pmatrix}$
          &
          $\begin{pmatrix}
              -\frac{4}{11} \\
              \frac{24}{11} \\
              \frac{12}{11} \\
          \end{pmatrix}$
          &
          $0.0003888866667$ \\
          \hline
          ~\eqref{syst5}
          &
          $\begin{pmatrix}
              1.00000 \\
              -0.81145 \\
              1.27048 \\
              -0.46016 \\
              1.56790 \\
              0.05780 \\
              2.05345 \\
              0.88005 \\
              1.86675 \\
              2.06675 \\
           \end{pmatrix}$
          &
          $\begin{pmatrix}
              1 \\
              -\frac{241}{297} \\
              \frac{1132}{891} \\
              -\frac{410}{891} \\
              \frac{127}{81} \\
              \frac{103}{1782} \\
              \frac{4879}{2376} \\
              
              \frac{697}{792} \\
              \frac{22177}{11880} \\
              \frac{24553}{11880} \\
          \end{pmatrix}$
          &
          $0.0001766790236$ \\
	    \hline

         \end{tabular}
         \renewcommand{\arraystretch}{1}
         \newpage
        \renewcommand{\arraystretch}{2}
        \begin{tabular}{|c|c|c|c|}
           \hline
           Système & Résultat obtenu & Résultat théorique & Ecart (en \%) \\ % ajout de hline entre chaque ligne pour séparer
          %debut eq6
           \hline
           ~\eqref{syst6}
           &
           $\begin{pmatrix}
              -1.64286 \\
              1.57143 \\
              1.35714 \\
          \end{pmatrix}$
           &
           $\begin{pmatrix}
              -\frac{23}{14} \\
              \frac{11}{7} \\
              \frac{19}{14} \\
          \end{pmatrix}$
          &
          $0.0001584521670$ \\
          %fin eq6
          %debut eq7
           \hline
           ~\eqref{syst7}
           &
           $\begin{pmatrix}
              0.26370 \\
              0.17294 \\
              0.07150 \\
          \end{pmatrix}$
           &
           $\begin{pmatrix}
              \frac{645}{2446} \\
              \frac{423}{2446} \\
              \frac{1749}{24460} \\
          \end{pmatrix}$
          &
          $0.003509317007$ \\
          %fin eq7
          %debut eq8
           \hline
           ~\eqref{syst8}
           &
           $\begin{pmatrix}
              1.00000 \\
              -2.00000 \\
              -2.00000 \\
              7.00000 \\
          \end{pmatrix}$
           &
           $\begin{pmatrix}
              1 \\
              -2 \\
              -2 \\
              7 \\
          \end{pmatrix}$
          &
          $0$ \\
          %fin eq8
          %debut eq9
           \hline
           ~\eqref{syst9}
           &
           $\begin{pmatrix}
              0.00707 \\
              0.00843 \\
              0.00848 \\
          \end{pmatrix}$
           &
           $\begin{pmatrix}
              \frac{1435}{203107} \\
              \frac{1712}{203107} \\
              \frac{1723}{203107} \\
          \end{pmatrix}$
          &
          $0.03881495963$ \\
          %fin eq9
          %debut eq10
           \hline
           ~\eqref{syst10}
           &
           $\begin{pmatrix}
              0.53333 \\
              1.20000 \\
              1.80000 \\
              3.46667
          \end{pmatrix}$
           &
           $\begin{pmatrix}
              \frac{8}{15} \\
              \frac{6}{5} \\
              \frac{9}{5} \\
              \frac{52}{15} \\
          \end{pmatrix}$
          &
          $0.0001802844952$ \\
          %fin eq10
          \hline
         \end{tabular}
         \renewcommand{\arraystretch}{1}
    \newpage
    \section{Comparaison}
    Cette section permet de synthétiser les observations sur les résultats obtenus et d'évaluer les avantages et inconvenients des méthodes.
    Pour chaque méthode, on remarque que les résultats obtenus sur une précision de $10^{-5}$ sont les mêmes même si on peut supposer qu'ils diffèrent ensuite.
    Cependant, même avec une faible précision, l'écart entre les valeurs réelles est très faible (toujours à moins de 0.01\%).
    De plus, la vitesse de calcul des deux algorithmes est rapide même sur une matrice 10x10 et équivalente car leur compléxité est $O(n^3)$.
    \newline 
    Les conditions de la méthode de gauss sont relativement vérifiables. En effet, pour s'assurer l'existence d'une unique solution, il suffit de vérifier que le determinant n'est pas nul.
    Cette condition peut se vérifier directement aprés mise en échelon de la matrice en faisant le produit des éléments diagonaux.
    \newline
    Cependant, les calculs se font les uns à la suite des autres, on a besoin qu'une la ligne i-1 soit complétement modifiée pour opérer sur la ligne i.
    \newline
    L'avantage de la méthode de cholesky est la possibilité de faire les calculs en parralèle c'est-à-dire :
    lorsque les éléments avant la diagonale d'une ligne i d'une itération k  sont remplis, on peut calculer l'élément diagonale de la ligne i et continuer la recherche des éléments de l'itération k manquants.
    Mais l' inconvenient majeur de la méthode de cholesky est la vérification de  l'applicabilité de la méthode. En effet, pour savoir si la matrice est définie positive, on doit passer par le calcul
    des valeurs propres de la matrice qui est énormément couteux en nombre d'opération.
    
    
     
  \chapter{Méthodes itératives}
      On cherche à décomposer la matrice $A$ en $M$ et $N$ telles que $A = M-N$ avec $M$ facilement inversible.\\
      
      Le but est d'obtenir une solution approchée du système avec une certaine précision.\\
      A chaque itération, un nouveau vecteur résultat est calculé en fonction de celui de l'itération précédente, c'est la raison pour laquelle on doit définir un vecteur $x^{(0)}$ comme point initial.\\
      On peut donc calculer un résidu (i.e. un écart) à chaque itération. Lorsque cet écart devient inférieur à la précision demandée, on peut arrêter l'algorithme.
      
      Ces méthodes s'appliquent à des matrices dont les éléments diagonaux sont non-nuls.
      Pour chaque test ci-dessous, la précision utilisée est $10^{-5}$ et le vecteur initial est :
      $x^{(0)} = \begin{pmatrix}
		0 \\
		0 \\
		0 \\
		0 \\
		\end{pmatrix}$
  	\section{Méthode de Jacobi}
      Pour cette méthode, on doit avoir $M=D$ où $D$ est la diagonale de $A$, et $N=E+F$ où $-E$ et $-F$ sont respectivement les matrices composées des éléments du dessous et du dessus de la diagonale de $A$.\\
      Les critères d'application de la méthode de Jacobi sont les suivants :
      \begin{itemize}
        \item{$A$ doit être définie positive,}
        \item{$A$ doit être à diagonale dominante.}
      \end{itemize}
      La formule de calcul des composantes du vecteur x est la suivante :
       \newline
      $x_{i}^{(k+1)} = \frac{1}{a_{ii}} \cdot \left [ b_{i} - \sum_{j=1}^{i-1} a_{ij} \cdot x_{j}^{(k)} - \sum_{j=i+1}^{n} a_{ij} \cdot x_{j}^{(k)} \right ] $
  	  \subsection{Programme}
        \lstinputlisting[style=customc]{jacobi.c}
      \newpage
      \subsection{Résultats des tests}
        \renewcommand{\arraystretch}{2}
        \begin{tabular}{|c|c|c|c|c|}
          \hline
          Système & Résultat obtenu & Résultat théorique & Ecart (en \%) & Convergence\\ % ajout de hline entre chaque ligne pour séparer
          \hline
          ~\eqref{syst1}
          &
          $\begin{pmatrix}
              0.63414 \\
              -0.26829 \\
              0.17073 \\
              -0.58536 \\
          \end{pmatrix}$
          &
          $\begin{pmatrix}
              \frac{26}{41} \\
              -\frac{11}{41} \\
              \frac{7}{41} \\
              -\frac{24}{41} \\
          \end{pmatrix}$
          &
          $0.0009999982130$
          &
          18 itérations \\
          \hline
          ~\eqref{syst2}
          &
          $\begin{pmatrix}
              0.06132 \\
              0.24599 \\
              -0.00287 \\
              0.02177 \\
          \end{pmatrix}$
          &
          $\begin{pmatrix}
              \frac{3067}{50015} \\
              \frac{7382}{30009} \\
              -\frac{431}{150045} \\
              \frac{1089}{50015} \\
          \end{pmatrix}$
          &
          $0.02643817358$
          &
          17 itérations \\
          \hline
          ~\eqref{syst3}
          &
          $\begin{pmatrix}
              -0.04885 \\
              0.10345 \\
              0.04458 \\
              0.09623 \\
          \end{pmatrix}$
          &
          $\begin{pmatrix}
              -\frac{3375}{69088} \\
              \frac{7147}{69088} \\
              \frac{385}{8636} \\
              \frac{831}{8636} \\
          \end{pmatrix}$
          &
          $0.002650860195$
          &
          19 itérations \\
          \hline
          ~\eqref{syst4}
          &
          $\begin{pmatrix}
              -0.36364 \\
              2.18181 \\
              1.09091 \\
          \end{pmatrix}$
          &
          $\begin{pmatrix}
              -\frac{4}{11} \\
              \frac{24}{11} \\
              \frac{12}{11} \\
          \end{pmatrix}$
          &
          $0.0004861144443$
          &
          22 itérations \\
          \hline
          ~\eqref{syst5}
          &
          $\begin{pmatrix}
              1.00000 \\
              -0.81145 \\
              1.27048 \\
              -0.46016 \\
              1.56790 \\
              0.05780 \\
              2.05345 \\
              0.88005 \\
              1.86675 \\
              2.06675 \\
          \end{pmatrix}$
          &
          $\begin{pmatrix}
              1 \\
              -\frac{241}{297} \\
              \frac{1132}{891} \\
              -\frac{410}{891} \\
              \frac{127}{81} \\
              \frac{103}{1782} \\
              \frac{4879}{2376} \\
              \frac{697}{792} \\
              \frac{22177}{11880} \\
              \frac{24553}{11880} \\
          \end{pmatrix}$
          &
          $0.0001766790236$
          &
          70 itérations \\
      \hline
         \end{tabular}
         \renewcommand{\arraystretch}{1}
         \newpage
        \renewcommand{\arraystretch}{2}
        \begin{tabular}{|c|c|c|c|c|}
           \hline
           Système & Résultat obtenu & Résultat théorique & Ecart (en \%) & Convergence \\ % ajout de hline entre chaque ligne pour séparer
          %debut eq6
           \hline
           ~\eqref{syst6}
           &
           $\begin{pmatrix}
              -1.64286 \\
              1.57143 \\
              1.35714 \\
          \end{pmatrix}$
           &
           $\begin{pmatrix}
              -\frac{23}{14} \\
              \frac{11}{7} \\
              \frac{19}{14} \\
          \end{pmatrix}$
          &
          $0.0001584521670$
          &
          13 itérations \\
          %fin eq6
          %debut eq7
           \hline
           ~\eqref{syst7}
           &
           $\begin{pmatrix}
              0.26370 \\
              0.17293 \\
              0.07150 \\
          \end{pmatrix}$
           &
           $\begin{pmatrix}
              \frac{645}{2446} \\
              \frac{423}{2446} \\
              \frac{1749}{24460} \\
          \end{pmatrix}$
          &
          $0.003665329017$
          &
          17 itérations \\
          %fin eq7
          %debut eq8
           \hline
           ~\eqref{syst8}
           &
           $\begin{pmatrix}
              1.00000 \\
              -2.00000 \\
              -2.00000 \\
              7.00000 \\
          \end{pmatrix}$
           &
           $\begin{pmatrix}
              1 \\
              -2 \\
              -2 \\
              7 \\
          \end{pmatrix}$
          &
          $0$
          &
          21 itérations \\
          %fin eq8
          %debut eq9
           \hline
           ~\eqref{syst9}
           &
           $\begin{pmatrix}
              0.00707 \\
              0.00843 \\
              0.00848 \\
          \end{pmatrix}$
           &
           $\begin{pmatrix}
              \frac{1435}{203107} \\
              \frac{1712}{203107} \\
              \frac{1723}{203107} \\
          \end{pmatrix}$
          &
          $0.03881495963$
          &
          54 itérations \\
          %fin eq9
          %debut eq10
           \hline
           ~\eqref{syst10}
           &
           $\begin{pmatrix}
              0.53333 \\
              1.20000 \\
              1.80000 \\
              3.46667
          \end{pmatrix}$
           &
           $\begin{pmatrix}
              \frac{8}{15} \\
              \frac{6}{5} \\
              \frac{9}{5} \\
              \frac{52}{15} \\
          \end{pmatrix}$
          &
          $0.0001802844952$
          &
          18 itérations \\
          %fin eq10
          \hline
         \end{tabular}
         \renewcommand{\arraystretch}{1}
      
  	\newpage
  	\section{Méthode de Gauss-Seidel}
  	Pour cette méthode, on doit avoir $M=D-E$ où $D$ est la diagonale de $A$ et $-E$ la matrice composée des éléments dessous, et $N=F$ où $-F$ est la matrice composée des éléments du dessus de la diagonale de $A$.\\
      Les critères d'application de la méthode de Gauss-Seidel sont les suivants :
      \begin{itemize}
        \item{$A$ doit être définie positive,}
        \item{$A$ doit être à diagonale dominante,}
        \item{$A$ doit être définie symétrique.}
      \end{itemize}
      Cette méthode est plus restrictive que Jacobi, mais elle converge plus vite pour les matrices correspondant à ces critères d'application.\\
      
      En effet, lors de la génération d'un vecteur résultat à une itération $k$, l'algorithme n'utilisera les valeurs de l'itération $k-1$ que dans le cas où il ne connaît pas encore celles de l'itération en cours. \\
      
      C'est-à-dire qu'il utilisera les valeurs de l'itération en cours lorsqu'il cherchera à déterminer les valeurs d'indices inférieurs à l'indice de l'élément diagonal de la ligne itérée.
      On a ainsi la formule : 
      \newline
      $x_{i}^{(k+1)} = \frac{1}{a_{ii}} \cdot \left [ b_{i} - \sum_{j=1}^{i-1} a_{ij} \cdot x_{j}^{(k+1)} - \sum_{j=i+1}^{n} a_{ij} \cdot x_{j}^{(k)} \right ] $
      \newline
  	  \subsection{Programme}
        \lstinputlisting[style=customc]{gauss-seidel.c}
      \newpage
      \subsection{Résultats de tests}
      \renewcommand{\arraystretch}{2}
        \begin{tabular}{|c|c|c|c|c|}
          \hline
          Système & Résultat obtenu & Résultat théorique & Ecart & Convergence\\ % ajout de hline entre chaque ligne pour séparer
          \hline
          ~\eqref{syst1}
          &
          $\begin{pmatrix}
              0.63414 \\
              -0.26829 \\
              0.17073 \\
              -0.58537 \\
          \end{pmatrix}$
          &
          $\begin{pmatrix}
              \frac{26}{41} \\
              -\frac{11}{41} \\
              \frac{7}{41} \\
              -\frac{24}{41} \\
          \end{pmatrix}$
          &
          $0.0009270780048$
          &
          10 itérations \\
          \hline
          ~\eqref{syst2}
          &
          $\begin{pmatrix}
              0.06132 \\
              0.24599 \\
              -0.00287 \\
              0.02177 \\
          \end{pmatrix}$
          &
          $\begin{pmatrix}
              \frac{3067}{50015} \\
              \frac{7382}{30009} \\
              -\frac{431}{150045} \\
              \frac{1089}{50015} \\
          \end{pmatrix}$
          &
          $0.02643817358$
          &
          5 itérations \\
          \hline
          ~\eqref{syst3}
          &
          $\begin{pmatrix}
              -0.04885 \\
              0.10345 \\
              0.04458 \\
              0.09623 \\
          \end{pmatrix}$
          &
          $\begin{pmatrix}
              -\frac{3375}{69088} \\
              \frac{7147}{69088} \\
              \frac{385}{8636} \\
              \frac{831}{8636} \\
          \end{pmatrix}$
          &
          $0.002650860195$
          &
          7 itérations \\
          \hline
          ~\eqref{syst4}
          &
          $\begin{pmatrix}
              -0.36362 \\
              2.18181 \\
              1.09091 \\
          \end{pmatrix}$
          &
          $\begin{pmatrix}
              -\frac{4}{11} \\
              \frac{24}{11} \\
              \frac{12}{11} \\
          \end{pmatrix}$
          &
          $0.001652774444$
          &
          11 itérations \\
          \hline
          ~\eqref{syst5}
          &
          $\begin{pmatrix}
              1.00000 \\
			  -0.81145 \\
              1.27048 \\
              -0.46016 \\
              1.56790 \\
              0.05780 \\
              2.05345 \\
              0.88005 \\
              1.86675 \\
              2.06675 \\
          \end{pmatrix}$
          &
          $\begin{pmatrix}
              1 \\
              -\frac{241}{297} \\
              \frac{1132}{891} \\
              -\frac{410}{891} \\
              \frac{127}{81} \\
              \frac{103}{1782} \\
              \frac{4879}{2376} \\
              \frac{697}{792} \\
              \frac{22177}{11880} \\
              \frac{24553}{11880} \\
          \end{pmatrix}$
          &
          $0.0001766790236$
          &
          10 itérations \\
      \hline
         \end{tabular}
         \renewcommand{\arraystretch}{1}
         \newpage
        \renewcommand{\arraystretch}{2}
        \begin{tabular}{|c|c|c|c|c|}
           \hline
           Système & Résultat obtenu & Résultat théorique & Ecart & Convergence \\ % ajout de hline entre chaque ligne pour séparer
          %debut eq6
           \hline
           ~\eqref{syst6}
           &
           $\begin{pmatrix}
              -1.64286 \\
              1.57143 \\
              1.35714 \\
          \end{pmatrix}$
           &
           $\begin{pmatrix}
              -\frac{23}{14} \\
              \frac{11}{7} \\
              \frac{19}{14} \\
          \end{pmatrix}$
          &
          $0.0001584521670$
          &
          7 itérations \\
          %fin eq6
          %debut eq7
           \hline
           ~\eqref{syst7}
           &
           $\begin{pmatrix}
              0.26370 \\
              0.17294 \\
              0.07150 \\
          \end{pmatrix}$
           &
           $\begin{pmatrix}
              \frac{645}{2446} \\
              \frac{423}{2446} \\
              \frac{1749}{24460} \\
          \end{pmatrix}$
          &
          $0.003509317007$
          &
          9 itérations \\
          %fin eq7
          %debut eq8
           \hline
           ~\eqref{syst8}
           &
           $\begin{pmatrix}
              1.00000 \\
              -2.00000 \\
              -2.00000 \\
              7.00000 \\
          \end{pmatrix}$
           &
           $\begin{pmatrix}
              1 \\
              -2 \\
              -2 \\
              7 \\
          \end{pmatrix}$
          &
          $0$
          &
          12 itérations \\
          %fin eq8
          %debut eq9
           \hline
           ~\eqref{syst9}
           &
           $\begin{pmatrix}
              0.00707 \\
              0.00843 \\
              0.00848 \\
          \end{pmatrix}$
           &
           $\begin{pmatrix}
              \frac{1435}{203107} \\
              \frac{1712}{203107} \\
              \frac{1723}{203107} \\
          \end{pmatrix}$
          &
          $0.03881495963$
          &
          11 itérations \\
          %fin eq9
          %debut eq10
           \hline
           ~\eqref{syst10}
           &
           $\begin{pmatrix}
              0.53334 \\
              1.20000 \\
              1.80000 \\
              3.46667 \\
          \end{pmatrix}$
           &
           $\begin{pmatrix}
              \frac{8}{15} \\
              \frac{6}{5} \\
              \frac{9}{5} \\
              \frac{52}{15} \\
          \end{pmatrix}$
          &
          $0.0003365376202$
          &
          7 itérations \\
          %fin eq10
          \hline
         \end{tabular}
         \renewcommand{\arraystretch}{1}
     \newpage
     \section{Comparaison}
  \chapter{Conclusion}
    
	La méthode de Gauss est plus facile à appliquer et ses opérations sont des divisions, additions et multiplications alors que cholesky utilise en plus des calculs de carrés et de racine carrés ce qui engendre
    des erreurs de précision en plus. De plus, avec la résolution par la méthode de Cholesky, il faut résoudre un système triangulaire en plus ce qui ajoute encore des erreurs de calcul.
    Mais l'algorithme de Gauss oblige de calculer les éléments de façon séquentiels car une ligne i dépend totalement de la ligne i-1 alors que ceci n'est pas le cas avec la méthode de Cholesky.
    \newpage
  \chapter{Annexe}
    \section{Fonctions caractéristiques du calcul matriciel}
      \lstinputlisting[style=customc, label=headerMatrices]{matrices.h}
      \lstinputlisting[style=customc, label=sourceMatrices]{matrices.c}
      \newpage
    \section{Génération de matrices aléatoires}
      \lstinputlisting[style=customc]{generateur.h}
      \lstinputlisting[style=customc]{generateur.c}
      \newpage
    \section{Méthode de Sur-relaxation}
    La méthode de Sur-relaxation est aussi une méthode itérative. Elle est semblable à la méthode de Gauss-Seidel dans son principe c'est à dire que
    l'algorithme  n'utilise les valeurs de l'itération $k-1$ que dans le cas où il ne connaît pas encore celles de l'itération en cours.
    \newline
    De plus, ses conditions de convergence sont les mêmes c'est à dire que la matrice : 
          \begin{itemize}
        \item{$A$ doit être définie positive,}
        \item{$A$ doit être à diagonale dominante.}
      \end{itemize}
    La différence entre ces deux méthodes est l'ajout d'un facteur $ \omega $ qui, s'il est bien choisi, accélère la convergence etle choix des matrices $M$ et $N$. 
    \newline
    En effet, $M = \frac{1}{\omega} \cdot D - E$ et $N = - \left( 1- \frac{1}{\omega} \right) \cdot D + F $.
    \newline
    On a alors la formule de calcul des composantes de $x$ à pour une itération k+1 :
    \newline
    $x_{i}^{(k+1)} = (1 - \omega) \cdot x_{i}^{(k)} +  \frac{\omega}{a_{ii}} \cdot \left [ b_{i} - \sum_{j=1}^{i-1} a_{ij} \cdot x_{j}^{(k+1)} - \sum_{j=i+1}^{n} a_{ij} \cdot x_{j}^{(k)} \right ] $
      \newline
      \subsection{Programme}
        \lstinputlisting[style=customc]{surrelaxation.c}
  
\end{document}